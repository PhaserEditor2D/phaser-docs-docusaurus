"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["87274"],{81996:function(e,t,n){n.r(t),n.d(t,{metadata:()=>s,default:()=>h,frontMatter:()=>r,contentTitle:()=>c,toc:()=>l,assets:()=>d});var s=JSON.parse('{"id":"phaser-editor/scene-editor/scene-compiler","title":"The scene compiler","description":"Traditionally, a game engine has its file format to create scenes and part of its API is focused on the integration with a scene editor.","source":"@site/docs/phaser-editor/scene-editor/scene-compiler.md","sourceDirName":"phaser-editor/scene-editor","slug":"/phaser-editor/scene-editor/scene-compiler","permalink":"/phaser-editor/scene-editor/scene-compiler","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"slug":"scene-compiler","title":"The scene compiler"},"sidebar":"PhaserEditorSidebar","previous":{"title":"Sorting layout tools","permalink":"/phaser-editor/scene-editor/layout-tools/layout-tools-sorting"},"next":{"title":"Miscellaneous","permalink":"/phaser-editor/scene-editor/misc"}}'),i=n(74848),o=n(28453);let r={slug:"scene-compiler",title:"The scene compiler"},c,d={},l=[{value:"Executing the compiler",id:"executing-the-compiler",level:2},{value:"User code",id:"user-code",level:2},{value:"Editing the generated code",id:"editing-the-generated-code",level:3},{value:"Compiler settings",id:"compiler-settings",level:2},{value:"Scene settings",id:"scene-settings",level:2}];function a(e){let t={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"Traditionally, a game engine has its file format to create scenes and part of its API is focused on the integration with a scene editor."}),"\n",(0,i.jsx)(t.p,{children:"Phaser is not a traditional game engine, it is a framework, and is not attached to any particular tool. To create a Phaser game you only need a simple text editor."}),"\n",(0,i.jsx)(t.p,{children:"Of course, Phaser provides API to interact with some widely used, third-party formats like texture atlas, tilemap, bitmap fonts, etc\u2026 But there is not a complete scene format where all the elements could be integrated."}),"\n",(0,i.jsx)(t.p,{children:"For the Scene Editor, we use a custom scene-file format, but instead of creating a custom library to parse and create the Phaser scenes on the fly, we created a compiler."}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.a,{href:"../scene-editor/scene-compiler",children:"scene compiler"})," takes as input the custom scene files (based on JSON) and generates well-written Phaser code. In other words, the ",(0,i.jsx)(t.a,{href:"../scene-editor/scene-compiler",children:"scene compiler"})," writes the Phaser code for you."]}),"\n",(0,i.jsx)(t.p,{children:"This has some advantages:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Your game doesn\u2019t need to load an extra, third-party library."}),"\n",(0,i.jsx)(t.li,{children:"You have full comprehension of how the scene objects are created."}),"\n",(0,i.jsx)(t.li,{children:"A modern JavaScript editor can process the scene code and integrates it with the content assist tools."}),"\n",(0,i.jsx)(t.li,{children:"You can customize certain aspects of the generated code and/or insert your code."}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"executing-the-compiler",children:"Executing the compiler"}),"\n",(0,i.jsx)(t.p,{children:"You have multiple options to compile a scene file:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"When you save the modifications of a scene file in the Scene Editor the scene is compiled automatically."}),"\n",(0,i.jsxs)(t.li,{children:["In the context menu of the Scene Editor you can click on the ",(0,i.jsx)(t.strong,{children:"Compile Scene"})," command.\n",(0,i.jsx)(t.img,{src:"https://cdn.phaser.io/editor-docs/scene-compiler-command-in-scene-editor-04272020.webp",alt:"Compile scene command in context menu."})]}),"\n",(0,i.jsxs)(t.li,{children:["The ",(0,i.jsx)(t.strong,{children:"Compile Project"})," command compiles all the files of the project, including the scene files. You can execute the command with the ",(0,i.jsx)(t.code,{children:"Ctrl+Alt+B"})," keys. It is also available in the ",(0,i.jsx)(t.a,{href:"../workbench/main-menu",children:"Main menu"}),"."]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"user-code",children:"User code"}),"\n",(0,i.jsx)(t.p,{children:"The Scene Editor helps to build game levels, but it is far away to cover all aspects of a game. Especially, the game logic should be implemented by you, writing code."}),"\n",(0,i.jsx)(t.p,{children:"In Phaser programming, it is common to see, in the same file, code to create the objects of the level (what the Scene Editor is good for) and code to handle the interaction between the objects (the game logic, that is not targeted by the Scene Editor)."}),"\n",(0,i.jsxs)(t.p,{children:["We designed the ",(0,i.jsx)(t.a,{href:"../scene-editor/scene-compiler",children:"scene compiler"})," to allow you to merge the generated code with your code, in the same file."]}),"\n",(0,i.jsx)(t.p,{children:"The concept is simple:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["The ",(0,i.jsx)(t.a,{href:"../scene-editor/scene-compiler",children:"scene compiler"})," creates the initial JavaScript file."]}),"\n",(0,i.jsxs)(t.li,{children:["The initial file contains protected regions, where the user can insert its code. These regions are delimited by JavaScript comments like ",(0,i.jsx)(t.code,{children:"/* START-USER-CODE */"})," and ",(0,i.jsx)(t.code,{children:"/* END-USER-CODE */"}),"."]}),"\n",(0,i.jsx)(t.li,{children:"You can insert your code inside the protected regions."}),"\n",(0,i.jsx)(t.li,{children:"The next time the file is updated by the compiler, the user protected regions are preserved, it means, your code is not changed, only the code generated by the compiler is updated."}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.a,{href:"../scene-editor/scene-compiler",children:"scene compiler"})," uses different comments to delimit the user code:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["From the beginning of the file to the start of the ",(0,i.jsx)(t.code,{children:"/* START OF COMPILED CODE */"})," comment."]}),"\n",(0,i.jsxs)(t.li,{children:["From the end of the ",(0,i.jsx)(t.code,{children:"/* END OF COMPILED CODE */"})," comment to the end of the file."]}),"\n",(0,i.jsxs)(t.li,{children:["From the end of the ",(0,i.jsx)(t.code,{children:"/* START-USER-IMPORT */"})," comment to the start of the ",(0,i.jsx)(t.code,{children:"/* END-USER-IMPORT-CODE */"})," comment."]}),"\n",(0,i.jsxs)(t.li,{children:["From the end of the ",(0,i.jsx)(t.code,{children:"/* START-USER-CTR-CODE */"})," comment to the start of the ",(0,i.jsx)(t.code,{children:"/* END-USER-CTR-CODE */"})," comment."]}),"\n",(0,i.jsxs)(t.li,{children:["From the end of the ",(0,i.jsx)(t.code,{children:"/* START-USER-CODE */"})," comment to the start of the ",(0,i.jsx)(t.code,{children:"/* END-USER-CODE */"})," comment."]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["The next image is an example. Look that you can import a ",(0,i.jsx)(t.code,{children:"MyUtils"})," class and use it in the ",(0,i.jsx)(t.code,{children:"create()"})," method:"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://cdn.phaser.io/editor-docs/scene-compiler-user-code-27022022.webp",alt:"User code."})}),"\n",(0,i.jsx)(t.h3,{id:"editing-the-generated-code",children:"Editing the generated code"}),"\n",(0,i.jsxs)(t.p,{children:["The code generated by the ",(0,i.jsx)(t.a,{href:"../scene-editor/scene-compiler",children:"scene compiler"})," can be edited in an external editor (like ",(0,i.jsx)(t.a,{href:"https://code.visualstudio.com",children:"Visual Studio Code"}),") or using the ",(0,i.jsx)(t.a,{href:"https://microsoft.github.io/monaco-editor/",children:"Monaco editor"})," that is built-in in Phaser Editor."]}),"\n",(0,i.jsxs)(t.p,{children:["We recommend you to read the ",(0,i.jsx)(t.a,{href:"../code-editor/intro",children:"Code Editor"})," chapter."]}),"\n",(0,i.jsxs)(t.p,{children:["The Scene Editor provides two commands to quickly edit the code file generated by the ",(0,i.jsx)(t.a,{href:"../scene-editor/scene-compiler",children:"scene compiler"}),":"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://cdn.phaser.io/editor-docs/scene-compiler-edit-code-menu-02242021.webp",alt:"Commands to edit the Scene Compiler output code."})}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.strong,{children:"Open Output File"})," command opens the generated file in a new ",(0,i.jsx)(t.a,{href:"../code-editor/intro",children:"Code Editor"}),", in the traditional way."]}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.strong,{children:"Open Output File in VS Code"})," (",(0,i.jsx)(t.code,{children:"Ctrl+Alt+E"}),") command launches a local ",(0,i.jsx)(t.a,{href:"https://code.visualstudio.com",children:"Visual Studio Code"})," instance (or any other configured external editor) that opens the generated file."]}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.strong,{children:"Quick Edit Output File"})," command (bound to the ",(0,i.jsx)(t.code,{children:"Q"})," key) opens the generated file in a ",(0,i.jsx)(t.a,{href:"../code-editor/intro",children:"Code Editor"})," that is embedded in a modal dialog. This way is perfect for quick modifications, however, intellisense and all the other ",(0,i.jsx)(t.a,{href:"https://microsoft.github.io/monaco-editor/",children:"Monaco editor"})," features are enabled, so you have a similar experience in comparison with the traditional way of editing."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://cdn.phaser.io/editor-docs/scene-compiler-quick-edit-code-06092020.webp",alt:"Quick editing of compiled code."})}),"\n",(0,i.jsx)(t.h2,{id:"compiler-settings",children:"Compiler settings"}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.a,{href:"../scene-editor/scene-compiler",children:"scene compiler"})," uses two different sets of parameters to refine the code generation of a Phaser scene and a prefab file. However, there are general, or shared settings, used in both cases:"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"general settings",src:n(2176).A+"",width:"726",height:"682"})}),"\n",(0,i.jsx)(t.p,{children:"The parameters:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Generate Code"}),": un-check it if you don\u2019t want the compiler to compile the file. In the ",(0,i.jsx)(t.a,{href:"./prefabs/prefab-black-box",children:"Using a prefab as a black box"})," section there is an example that uses a scene file without code generation."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Output Language"}),": you can select if the scene is compiled into JavaScript or TypeScript. In case you select TypeScript, you need to compile yourself the TypeScript generated files, with the TypeScript compiler (",(0,i.jsx)(t.code,{children:"tsc"}),")."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Fields In Constructor (JS)"}),": enable this for generating the initialization of the attributes in the class constructor. By default it is false and the fields are initialized in the class declaration. This parameter is used only when the output language is JavaScript."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Declare Fields (JS)"}),": disable this field to skip declaring the fields in the class. This is useful when you want to use the fields in the class without declaring them. This parameter is used only when the output language is JavaScript."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Export Class (ES Module)"}),": includes the ",(0,i.jsx)(t.code,{children:"export default"})," class modifiers."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Auto Import (ES Module)"}),": adds \u201Cimport\u201D statements for importing the types used in different parts of the code generation. Code written by the user is not processed. If you use other types, you should import them manually."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Import File Extension (ES Module)"}),": adds the ",(0,i.jsx)(t.code,{children:".js"})," extension to the import statements generated by the compiler. By default, the extensions are omitted."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Super Class"}),": you can force the generated class (prefab or scene), to extends the given class. If empty, the compiler will detect the appropriate class."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Allow User Class Modifiers (TS)"}),": if checked, the compiler generates a user code region to allow the user to declare the class modifiers. This is available only for TypeScript output. The user code region is delimited by the ",(0,i.jsx)(t.code,{children:"/* START-USER-CLASS-MODIFIERS */"})," and ",(0,i.jsx)(t.code,{children:"/* END-USER-CLASS-MODIFIERS */"})," comments."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Allow User Interfaces (TS)"}),": if checked, the compiler generates a user code region to allow the user to declare the interface of the class. This is available only for TypeScript output. The user code region is delimited by the ",(0,i.jsx)(t.code,{children:"/* START-USER-INTERFACES */"})," and ",(0,i.jsx)(t.code,{children:"/* END-USER-INTERFACES */"})," comments."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Insert Spaces"}),": if checked, the tabs will be converted to spaces."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Tab Size"}),": the number of spaces to be used if the ",(0,i.jsx)(t.strong,{children:"Insert Spaces"})," option is checked."]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["By the way, the name of the file and the class that is generated by the compiler is the same as the scene file. For example, a ",(0,i.jsx)(t.code,{children:"Zombie.scene"})," file is compiled into ",(0,i.jsx)(t.code,{children:"Zombie.js"})," (or ",(0,i.jsx)(t.code,{children:"Zombie.ts"}),") and the name of the class will be ",(0,i.jsx)(t.code,{children:"Zombie"}),"."]}),"\n",(0,i.jsx)(t.h2,{id:"scene-settings",children:"Scene settings"}),"\n",(0,i.jsxs)(t.p,{children:["The compilation of a Phaser scene can be tweaked with the ",(0,i.jsx)(t.strong,{children:"Compiler Scene Settings"}),":"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://cdn.phaser.io/editor-docs/scene-compiler-scene-settings-04272020.webp",alt:"Scene settings."})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Scene Key"}),": you can set the ",(0,i.jsx)(t.a,{href:"https://docs.phaser.io/api-documentation/class/types-scenes#-settingsconfig",children:"Phaser.Scene configuration key"}),". Is optional."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Only Generate Methods"}),": if checked, instead of generate a ",(0,i.jsx)(t.a,{href:"https://docs.phaser.io/api-documentation/class/types-scenes",children:"Phaser.Scene"})," class, the compiler generates only the ",(0,i.jsx)(t.strong,{children:"create"})," and ",(0,i.jsx)(t.strong,{children:"preload"})," methods:"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://cdn.phaser.io/editor-docs/scene-compiler-scene-settings-only-methods-04272020.webp",alt:"Only generate methods."})}),"\n",(0,i.jsx)(t.p,{children:"This could be useful if you want to create the objects using any context:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-javascript",children:"create.call(anySceneLikeContext);\n"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Create Method"}),": the compiler generates all the \u201Ccreation code\u201D in a method with the name you set in this parameter. By default, the name is ",(0,i.jsx)(t.code,{children:"editorCreate"}),". The first time you create a scene, it has a ",(0,i.jsx)(t.code,{children:"create"})," method that calls the ",(0,i.jsx)(t.code,{children:"editorCreate"})," method generated by the editor:"]}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-javascript",children:'/* START OF COMPILED CODE */\n\nclass Level2 extends Phaser.Scene {\n\n    constructor() {\n        super("Level2");\n\n    }\n\n    editorCreate() {\n\n        // dino\n        const dino = this.add.image(346, 233, "dino");\n\n        // fields\n        this.dino = dino;\n    }\n\n    /* START-USER-CODE */\n\n    // this is the method called by Phaser,\n    // when the scene is created.\n    create() {\n\n        this.editorCreate();\n\n        // you can add more code here\n\n        this.dino.setInteractive()\n            .on("pointerdown", () ={\n                // do something\n            });\n    }\n\n    /* END-USER-CODE */\n}\n\n/* END OF COMPILED CODE */\n'})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Preload Pack Files"}),": you can select the pack files to be loaded in the scene. If you click on the button, it opens the ",(0,i.jsx)(t.strong,{children:"Select Pack Files"})," dialog:"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://cdn.phaser.io/editor-docs/scene-compiler-scene-settings-load-pack-file-04272020.webp",alt:"Load asset pack files."})}),"\n",(0,i.jsxs)(t.p,{children:["If you select to load a pack file, then the compiler generates a ",(0,i.jsx)(t.strong,{children:"preload"})," method:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-javascript",children:'class Level extends Phaser.Scene {\n\n    preload() {\n        this.load.pack("asset-pack", "assets/asset-pack.json");\n    }\n\n    create() {\n        // ...\n    }\n}\n'})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Preload Method"}),": like the ",(0,i.jsx)(t.strong,{children:"Create Method"}),", you can change the name of the ",(0,i.jsx)(t.strong,{children:"preload"})," method generated by the compiler. Then, you can write your own ",(0,i.jsx)(t.strong,{children:"preload"})," method and call the one of the editor."]}),"\n"]})]})}function h(e={}){let{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},2176:function(e,t,n){n.d(t,{A:()=>s});let s=n.p+"assets/images/scene-compiler-general-settings-20251125-d8380b3390fe176a8735735224752f82.webp"},28453:function(e,t,n){n.d(t,{R:()=>r,x:()=>c});var s=n(96540);let i={},o=s.createContext(i);function r(e){let t=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);