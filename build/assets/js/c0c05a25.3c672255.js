"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["30899"],{86190:function(e,t,n){n.r(t),n.d(t,{metadata:()=>s,default:()=>h,frontMatter:()=>a,contentTitle:()=>i,toc:()=>d,assets:()=>c});var s=JSON.parse('{"id":"phaser-editor/scene-editor/prefabs/prefab-black-box","title":"Using a prefab as a black box","description":"At this moment, the Scene Editor supports a small subset of the object types present in the Phaser API. Eventually, we will implement support for all the built-in object types.","source":"@site/docs/phaser-editor/scene-editor/prefabs/prefab-black-box.md","sourceDirName":"phaser-editor/scene-editor/prefabs","slug":"/phaser-editor/scene-editor/prefabs/prefab-black-box","permalink":"/phaser-editor/scene-editor/prefabs/prefab-black-box","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"slug":"prefab-black-box","title":"Using a prefab as a black box"},"sidebar":"PhaserEditorSidebar","previous":{"title":"Unboxing a prefab instance","permalink":"/phaser-editor/scene-editor/prefabs/prefab-unbox"},"next":{"title":"Script Nodes","permalink":"/phaser-editor/scene-editor/script-node"}}'),o=n(74848),r=n(28453);let a={slug:"prefab-black-box",title:"Using a prefab as a black box"},i,c={},d=[];function l(e){let t={a:"a",code:"code",img:"img",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(t.p,{children:["At this moment, the Scene Editor supports a small subset of the object types present in the ",(0,o.jsx)(t.a,{href:"https://newdocs.phaser.io/docs/latest/",children:"Phaser API"}),". Eventually, we will implement support for all the built-in object types."]}),"\n",(0,o.jsx)(t.p,{children:"However, if you need to add to the scene an object of an unsupported type (a Phaser object type or any other no fully supported by Phaser) you can \u201Ccheat\u201D the Scene Editor using a Prefab as a black box."}),"\n",(0,o.jsxs)(t.p,{children:["A Prefab as a black box is a very simple concept: it is a Prefab that is not compiled by the ",(0,o.jsx)(t.a,{href:"../../scene-editor/scene-compiler",children:"scene compiler"}),", so you should write the code of the Prefab class manually."]}),"\n",(0,o.jsx)(t.p,{children:"For example, let\u2019s say you want to add to the scene some objects with a texture that is generated on the fly, with shapes of random colors and positions. Let\u2019s name them \u201Cdoodles\u201D."}),"\n",(0,o.jsx)(t.p,{children:"First, create a texture similar to what you want, at least, with the same dimensions (100x100 in this example)."}),"\n",(0,o.jsx)(t.p,{children:"Something like this:"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{src:"https://cdn.phaser.io/editor-docs/scene-editor-prefab-black-box-doodle.webp",alt:"A reference image for the custom object."})}),"\n",(0,o.jsxs)(t.p,{children:["It is a reference texture. Upload it to the project and add it to the ",(0,o.jsx)(t.a,{href:"../../asset-pack-editor/asset-pack-file",children:"Asset Pack file"}),". You can create a new ",(0,o.jsx)(t.a,{href:"../../asset-pack-editor/asset-pack-file",children:"Asset Pack file"})," that will be used only by the editor, so you can exclude it from the distribution build of the game."]}),"\n",(0,o.jsxs)(t.p,{children:["So, create a ",(0,o.jsx)(t.strong,{children:"Doodle"})," Prefab with the ",(0,o.jsx)(t.strong,{children:"doodle"})," texture:"]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{src:"https://cdn.phaser.io/editor-docs/scene-editor-prefab-black-box-1.webp",alt:"Add the doodle image to the prefab file."})}),"\n",(0,o.jsxs)(t.p,{children:["We have our Prefab. But you want to generate the texture on the fly. To do this, first disable the compilation of the scene, in the ",(0,o.jsx)(t.a,{href:"../scene-compiler#compiler-settings",children:"Scene compiler settings"}),":"]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{src:"https://cdn.phaser.io/editor-docs/scene-editor-prefab-black-box-2.webp",alt:"Disable code generation."})}),"\n",(0,o.jsxs)(t.p,{children:["Now that you disabled the code compilation, you have to write the ",(0,o.jsx)(t.code,{children:"Doodle"})," class in the ",(0,o.jsx)(t.code,{children:"Doodle.js"})," file. It is a simple class, it extends the ",(0,o.jsx)(t.a,{href:"https://docs.phaser.io/api-documentation/class/gameobjects-image",children:"Phaser.GameObjects.Image"})," but instead of a real image texture it will generate its texture, on the fly:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-javascript",children:'class Doodle extends Phaser.GameObjects.Image {\n\n    static ID = 0;\n    static COLORS = ["red", "blue", "orange"];\n\n    /**\n     * @param scene {Phaser.Scene}\n     */\n    constructor(scene, x, y) {\n        super(scene, x, y);\n\n        // create a new texture key\n        Doodle.ID++;\n        const key = "doodle-" + Doodle.ID;\n\n        // create a new canvas-based texture and add it\n        // to the TextureManager with the new key\n        const texture = scene.textures.createCanvas(key, 200, 200);\n\n        // get the context of the texture and draw the random doodle\n        const ctx = texture.getContext();\n\n        ctx.strokeStyle = "black";\n\n        // draw 5 shapes\n        for (let i = 0; i < 5; i++) {\n\n            ctx.save();\n\n            // add a little rotation to the shape\n            const angle = Phaser.Math.RND.integerInRange(-10, 10);\n            ctx.rotate(Phaser.Math.DegToRad(angle));\n\n            ctx.beginPath();\n\n            // draw a rect, at a random position with a random size\n            ctx.rect(\n                Phaser.Math.RND.integerInRange(0, 50),\n                Phaser.Math.RND.integerInRange(0, 50),\n                Phaser.Math.RND.integerInRange(20, 50),\n                Phaser.Math.RND.integerInRange(20, 50));\n\n            // fill it with a random color\n            const color = Phaser.Math.RND.pick(Doodle.COLORS);\n            ctx.fillStyle = color;\n\n            ctx.fill();\n            ctx.stroke();\n\n            ctx.restore();\n        }\n\n        // needed if the game is using the WebGL renderer\n        texture.refresh();\n\n        // set the new texture to the object\n        this.setTexture(key);\n    }\n\n}\n'})}),"\n",(0,o.jsxs)(t.p,{children:["The ",(0,o.jsx)(t.strong,{children:"Doodle"})," Prefab is ready. Open the ",(0,o.jsx)(t.strong,{children:"Level"})," scene file and add a couple of ",(0,o.jsx)(t.strong,{children:"Doodle"})," prefab instance to it:"]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{src:"https://cdn.phaser.io/editor-docs/scene-editor-prefab-black-box-3.webp",alt:"The Doodle prefab instances in the level scene."})}),"\n",(0,o.jsxs)(t.p,{children:["Note all ",(0,o.jsx)(t.strong,{children:"Doodle"})," instances look the same. The custom code you wrote is executed in the game, not in the editor. The editor is using the ",(0,o.jsx)(t.code,{children:"doodle.png"})," image you created as a reference."]}),"\n",(0,o.jsxs)(t.p,{children:["Look in the ",(0,o.jsx)(t.code,{children:"Level.js"})," file: the prefab instance are created as expected.  The trick here is that the code inside the ",(0,o.jsx)(t.strong,{children:"Doodle"})," constructor is your code, not the code generated by the ",(0,o.jsx)(t.a,{href:"../../scene-editor/scene-compiler",children:"scene compiler"}),". You only need to write a constructor signature that is compatible with the code of the ",(0,o.jsx)(t.code,{children:"Level.js"})," file:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-javascript",children:'class Level extends Phaser.Scene {\n\n    constructor() {\n        super("Level");\n\n    }\n\n    create() {\n\n        // ...\n\n        // doodle\n        const doodle = new Doodle(this, 388, 105);\n        this.add.existing(doodle);\n\n        // doodle_1\n        const doodle_1 = new Doodle(this, 380, 240);\n        this.add.existing(doodle_1);\n\n        // doodle_2\n        const doodle_2 = new Doodle(this, 530, 170);\n        this.add.existing(doodle_2);\n\n        // ...\n    }\n\n}\n'})}),"\n",(0,o.jsxs)(t.p,{children:["So, run the game now: you will see the ",(0,o.jsx)(t.strong,{children:"Doodle"})," instances are rendered with random shapes and colors. The instances are using your custom code and your way to create the textures:"]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{src:"https://cdn.phaser.io/editor-docs/scene-editor-prefab-black-box-4.webp",alt:"The different doodles in the game."})}),"\n",(0,o.jsxs)(t.p,{children:["This \u201Cblack box\u201D trick is not perfect. An ideal editor should run your ",(0,o.jsx)(t.strong,{children:"Doodle"})," custom code and show the prefab instance in the Scene Editor with the custom textures. But it is something very complex to implement."]}),"\n",(0,o.jsxs)(t.p,{children:["With a black box Prefab, you can do \u201Cblack magic\u201D. Think that using it you can place 3D objects in the scene, by using a third-party framework and the ",(0,o.jsx)(t.a,{href:"https://docs.phaser.io/api-documentation/class/gameobjects-extern",children:"Extern game object"}),". Or complex 2D objects modeled by animation tools. Or tile-maps created with a Phaser unsupported format."]})]})}function h(e={}){let{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},28453:function(e,t,n){n.d(t,{R:()=>a,x:()=>i});var s=n(96540);let o={},r=s.createContext(o);function a(e){let t=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);