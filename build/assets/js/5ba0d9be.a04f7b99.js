"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["25600"],{33469:function(e,n,t){t.r(n),t.d(n,{metadata:()=>s,default:()=>p,frontMatter:()=>r,contentTitle:()=>i,toc:()=>h,assets:()=>c});var s=JSON.parse('{"id":"phaser-editor/scene-editor/user-components/user-components-awake-event","title":"The awake event","description":"We propose using Phaser events for implementing the User Components behaviors. However, the events provided in Phaser are not enough. When you create a component, all properties are set with the default values. Then, you set the value of each property. However, maybe you want to perform a custom initialization routine after all properties are set.","source":"@site/docs/phaser-editor/scene-editor/user-components/user-components-awake-event.md","sourceDirName":"phaser-editor/scene-editor/user-components","slug":"/phaser-editor/scene-editor/user-components/user-components-awake-event","permalink":"/phaser-editor/scene-editor/user-components/user-components-awake-event","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"slug":"user-components-awake-event","title":"The awake event"},"sidebar":"PhaserEditorSidebar","previous":{"title":"A base class for your components","permalink":"/phaser-editor/scene-editor/user-components/user-components-super-class"},"next":{"title":"Adding User Components to a Game Object","permalink":"/phaser-editor/scene-editor/user-components/user-components-instancing"}}'),o=t(74848),a=t(28453);let r={slug:"user-components-awake-event",title:"The awake event"},i,c={},h=[];function l(e){let n={a:"a",code:"code",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"We propose using Phaser events for implementing the User Components behaviors. However, the events provided in Phaser are not enough. When you create a component, all properties are set with the default values. Then, you set the value of each property. However, maybe you want to perform a custom initialization routine after all properties are set."}),"\n",(0,o.jsxs)(n.p,{children:["Looking into the Phaser events, you can do it in the first scene\u2019s update. It means you can listen once for the ",(0,o.jsx)(n.strong,{children:"UPDATE"})," event and run the initialization routine. It may work in many cases. But maybe, you want to run this routine just after all properties are set, and before the game starts the update loop."]}),"\n",(0,o.jsxs)(n.p,{children:["For this reason, the ",(0,o.jsx)(n.a,{href:"../scene-compiler",children:"scene compiler"})," generates code for emitting a custom event, the ",(0,o.jsx)(n.code,{children:"scene-awake"})," event, just after it generates the code that creates the objects in the scene, and all their properties are set:\n.. code:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:'// code generated by the compiler:\n\neditorCreate() {\n\n    // creates the game object\n    const dino = this.add.image(400, 240, "FufuSuperDino");\n\n    // creates the PushOnClick component\n    const dinoPushOnClick = new PushOnClick(dino);\n\n    // sets the component\'s properties\n    dinoPushOnClick.pushDelay = 500;\n\n    // emit the scene-awake event, after all objects are created\n    // and all properties are set\n    dino.emit("scene-awake");\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["When you implement a component, you can register a listener on the ",(0,o.jsx)(n.strong,{children:"scene-awake"})," event:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:'class PushOnClick {\n\n    constructor(gameObject) {\n        ...\n\n        this.gameObject = gameObject;\n\n        gameObject.scene.events.once("scene-awake", () => {\n\n            // I register a "pointerdown"\n            // event for "animating" the game object\n            // with a push effect\n\n            // I set a pixel perfect handler\n            // with certain alpha-tolerance\n            const handler = this.scene.input\n                .makePixelPerfect(this.alphaTolerance);\n\n\n            this.gameObject.setInteractive(handler)\n                .on("pointerdown", () => {\n                    // animate the object with the push effect\n                    this.gameObject.scene.add.tween(...);\n                });\n        });\n    }\n\n    /** @type {number} **/\n    alphaTolerance = 100;\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["In the section ",(0,o.jsx)(n.a,{href:"./user-components-super-class",children:"A base class for your components"}),"), we explain how you can use a common super-class for all the components. It simplifies the listening of Phaser events, and it also includes the ",(0,o.jsx)(n.strong,{children:"scene-awake"})," event. So you can rewrite the previous ",(0,o.jsx)(n.strong,{children:"PushOnClick"})," component in this way:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:'class PushOnClick extends UserComponent {\n\n    constructor(gameObject) {\n        super(gameObject);\n    }\n\n    awake() {\n\n        // Instead of registering a scene-awake event listener\n        // you can override this method.\n\n        ...\n\n        this.gameObject.setInteractive(...)\n                .on("pointerdown", ...);\n        ...\n    }\n    ...\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"scene-awake"})," event is emitted in the ",(0,o.jsx)(n.code,{children:"editorCreate()"})," method of a scene. So, if you create a new component and this component listens to the ",(0,o.jsx)(n.code,{children:"scene-awake"})," event, then you should emit that event manually:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:'const comp = new PushOnClick(someSprite);\ncomp.alphaTolerance = 50;\n// emit the awake event so the component can be notified\nthis.events.emit("scene-awake");\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Emitting the ",(0,o.jsx)(n.code,{children:"scene-awake"})," event later in the game is safe because components and prefabs handle this event only once in their lifetime."]}),"\n",(0,o.jsxs)(n.p,{children:["The prefabs also listens to the ",(0,o.jsx)(n.code,{children:"scene-awake"})," event. ",(0,o.jsx)(n.a,{href:"../prefabs/prefab-user-properties#the-scene-awake-event",children:"Learn more about it"}),"."]})]})}function p(e={}){let{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},28453:function(e,n,t){t.d(n,{R:()=>r,x:()=>i});var s=t(96540);let o={},a=s.createContext(o);function r(e){let n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);