"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([["10328"],{65472:function(e,n,s){s.r(n),s.d(n,{metadata:()=>t,default:()=>d,frontMatter:()=>a,contentTitle:()=>c,toc:()=>h,assets:()=>o});var t=JSON.parse('{"id":"phaser-editor/scene-editor/prefabs/prefab-nested","title":"Nested prefabs","description":"The nested prefab is a powerful concept. Like the overall prefab concept, it is inspired by Unity Engine. Its name describes its purpose: allow nesting prefabs.","source":"@site/docs/phaser-editor/scene-editor/prefabs/prefab-nested.md","sourceDirName":"phaser-editor/scene-editor/prefabs","slug":"/phaser-editor/scene-editor/prefabs/prefab-nested","permalink":"/phaser-editor/scene-editor/prefabs/prefab-nested","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"slug":"prefab-nested","title":"Nested prefabs"},"sidebar":"PhaserEditorSidebar","previous":{"title":"Prefab variants","permalink":"/phaser-editor/scene-editor/prefabs/prefab-variant"},"next":{"title":"Adding children to a prefab instance","permalink":"/phaser-editor/scene-editor/prefabs/prefab-instance-children"}}'),r=s(74848),i=s(28453);let a={slug:"prefab-nested",title:"Nested prefabs"},c,o={},h=[{value:"Nested prefab instances",id:"nested-prefab-instances",level:2},{value:"The nested prefab constructor and the xargs",id:"the-nested-prefab-constructor-and-the-xargs",level:2},{value:"Things you cannot do with nested prefab instances",id:"things-you-cannot-do-with-nested-prefab-instances",level:2}];function p(e){let n={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["The nested prefab is a powerful concept. Like the overall prefab concept, it is inspired by ",(0,r.jsx)(n.a,{href:"https://unity.com",children:"Unity Engine"}),". Its name describes its purpose: allow nesting prefabs."]}),"\n",(0,r.jsxs)(n.p,{children:["There are many cases where your prefab is a compound of objects, and you would like to modify them in prefab instances. For example, look at this ",(0,r.jsx)(n.strong,{children:"AlienShip"})," prefab:"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://cdn.phaser.io/editor-docs/scene-editor-nested-prefab-alienship-08182021.webp",alt:"AlienShip, a prefab with nested prefabs."})}),"\n",(0,r.jsxs)(n.p,{children:["It is a container, with an ",(0,r.jsx)(n.strong,{children:"alien"})," and a ",(0,r.jsx)(n.strong,{children:"ship"})," children."]}),"\n",(0,r.jsxs)(n.p,{children:["When you create an instance of the ",(0,r.jsx)(n.strong,{children:"AlienPrefab"})," (that is an instance of a container), you can change its position, its scale. It\u2019s custom properties. But you cannot change the properties of the ",(0,r.jsx)(n.strong,{children:"ship"})," or the ",(0,r.jsx)(n.strong,{children:"alien"})," children."]}),"\n",(0,r.jsxs)(n.p,{children:["But if you declare the ",(0,r.jsx)(n.strong,{children:"alien"})," and ",(0,r.jsx)(n.strong,{children:"ship"})," objects as nested prefab, you can access them in the prefab instance."]}),"\n",(0,r.jsxs)(n.p,{children:["For setting an object as nested prefab, you select the ",(0,r.jsx)(n.strong,{children:"NESTED_PREFAB"})," option in the ",(0,r.jsx)(n.strong,{children:"Scope"})," parameter of the ",(0,r.jsx)(n.strong,{children:"Variable"})," section:"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://cdn.phaser.io/editor-docs/scene-editor-nested-prefab-scope-20230516.webp",alt:"Setting the nested prefab scope."})}),"\n",(0,r.jsxs)(n.p,{children:["Variables with a ",(0,r.jsx)(n.strong,{children:"NESTED_PREFAB"})," scopes are generated in code as public fields. It is like the ",(0,r.jsx)(n.strong,{children:"PUBLIC"})," scope but allowing to modify the object in prefab instances."]}),"\n",(0,r.jsx)(n.h2,{id:"nested-prefab-instances",children:"Nested prefab instances"}),"\n",(0,r.jsx)(n.p,{children:"When you create an instance of a prefab that contains nested prefabs, the Outline view shows the nested prefabs. Also, the Scene Editor allows selecting the nested prefab instance:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://cdn.phaser.io/editor-docs/scene-editor-nested-prefab-instance-08192021.webp",alt:"Prefab instance with nested prefabs."})}),"\n",(0,r.jsxs)(n.p,{children:["Note the nested prefab instance ",(0,r.jsx)(n.strong,{children:"ship"})," of the ",(0,r.jsx)(n.strong,{children:"AlienShip"}),"\u2019s prefab instance, has a different texture. Nested prefab instances work just like prefab instances: for changing a property, it first requires unlocking the property:"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://cdn.phaser.io/editor-docs/scene-editor-nested-prefab-instance-change-texture-08192021.webp",alt:"Changing the texture property of a nested prefab instance."})}),"\n",(0,r.jsxs)(n.p,{children:["The code generated for the ",(0,r.jsx)(n.strong,{children:"alien1"})," object is like this:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// alien1\nconst alien1 = new AlienShip(this, 142, 398);\nthis.add.existing(alien1);\nalien1.ship.setTexture("shipYellow");\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Note the nested prefab instance ",(0,r.jsx)(n.strong,{children:"ship"})," is a field of the prefab instance ",(0,r.jsx)(n.strong,{children:"alien1"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"the-nested-prefab-constructor-and-the-xargs",children:"The nested prefab constructor and the xargs"}),"\n",(0,r.jsx)(n.p,{children:"In most cases, when the user modifies a property of a nested prefab in the scene, the scene compiler generates a code like the one we saw in the previous example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'alien1 = new AlienShip(this, 142, 398);\n// ...\n// change the texture of the nested prefab instance **ship**\nalien1.ship.setTexture("shipYellow");\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Where ",(0,r.jsx)(n.code,{children:"alien1"})," is the instance of the parent prefab, and ",(0,r.jsx)(n.code,{children:"ship"})," is the instance of the nested prefab, and ",(0,r.jsx)(n.code,{children:"setTexture()"})," is a method to modify the ",(0,r.jsx)(n.code,{children:"texture"})," property. This is true for the vast majority of object types supported by Phaser, however, there are some object types that only receive their properties in the constructor. This means that once the object is created, it cannot be modified through a property."]}),"\n",(0,r.jsxs)(n.p,{children:["Suppose the nested prefab ",(0,r.jsx)(n.strong,{children:"ship"})," does not allow its texture to be modified through a method or property, but must be passed in the constructor. However, from the scene we only create the instance of the parent prefab ",(0,r.jsx)(n.strong,{children:"AlienShip"}),". It is in the ",(0,r.jsx)(n.strong,{children:"AlienShip"})," class where the ",(0,r.jsx)(n.strong,{children:"ship"})," object is created:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'class AlienShip extends Phaser.GameObjects.Container {\n\n    constructor(scene, x, y) {\n        super()\n        // ...\n        this.ship = scene.add.image(10, 10, "shipBlue");\n    }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["As you can see, ",(0,r.jsx)(n.strong,{children:"ship"})," receives the texture ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"shipBlue"})})," in its constructor. If we want to change the texture of ",(0,r.jsx)(n.strong,{children:"ship"})," in the scene, we should pass as argument also the texture of ",(0,r.jsx)(n.strong,{children:"ship"}),". It would look something like this:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'class AlienShip {\n    constructor(scene, x, y, key, frame, ship_key, ship_frame) {\n        // ...\n        this.ship = scene.add.image(scene, 10, 10, ship_key ?? "shipBlue", ship_frame);\n    }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"And the code in the scene would be:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'alien1 = new AlienShip(this, 142, 398, "shipYellow");\n'})}),"\n",(0,r.jsx)(n.p,{children:"This could be an option, but it has the disadvantage that in cases where the prefab contains several nested prefabs, and in turn each nested prefab has other nested prefabs, the constructor of the parent prefab becomes very long and difficult to read, since it would have to include all the parameters of all the nested prefabs."}),"\n",(0,r.jsxs)(n.p,{children:["Therefore, to simplify the constructor, the scene compiler will use a special argument to the prefab constructor called ",(0,r.jsx)(n.strong,{children:"xargs"})," (extra arguments). This argument contains the configuration of all nested prefabs in the format of a plain JavaScript object, and the nested prefabs will access it to take its parameters. The generated code for the above example would look something like this:"]}),"\n",(0,r.jsxs)(n.p,{children:["In the parent prefab ",(0,r.jsx)(n.strong,{children:"AlienShip"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'class AlienShip {\n    constructor(scene, x, y, xargs) {\n        // ...\n        this.ship = scene.add.image(scene, 10, 10, xargs?.ship?.key ?? "shipBlue", xargs?.ship?.frame);\n    }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"On the scene:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'alien1 = new AlienShip(this, 142, 398, { \n        ship: {\n            key: "shipYellow" \n        }\n    });\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Suppose the nested prefab ",(0,r.jsx)(n.strong,{children:"ship"})," were itself a prefab that has a nested prefab ",(0,r.jsx)(n.strong,{children:"engine"}),". In this case, the code in the parent prefab ",(0,r.jsx)(n.strong,{children:"AlienShip"})," would look something like this:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'class AlienShip {\n    constructor(scene, x, y, xargs) {\n        // ...\n        this.ship = new Ship(scene, 10, 10, xargs?.ship?.key ?? "shipBlue", xargs?.ship?.frame, { ...xargs?.ship, engine: xargs?.ship?.engine });\n    }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"y en la escena quedar\xeda:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'alien1 = new AlienShip(this, 142, 398, { \n        ship: {\n            key: "shipYellow",\n            engine: {\n                key: "engines",\n                frame: "red"\n            } \n        }\n    });\n'})}),"\n",(0,r.jsxs)(n.p,{children:["So far, only the ",(0,r.jsx)(n.a,{href:"../spine-animations/spine-animations-game-object",children:"SpineGameObject"})," type and all ",(0,r.jsx)(n.a,{href:"../box2d-physics",children:"Box2D"})," object types are the ones that require the use of the ",(0,r.jsx)(n.strong,{children:"xargs"})," argument."]}),"\n",(0,r.jsx)(n.h2,{id:"things-you-cannot-do-with-nested-prefab-instances",children:"Things you cannot do with nested prefab instances"}),"\n",(0,r.jsx)(n.p,{children:"In practice, nested prefabs are like prefabs, with certain differences:"}),"\n",(0,r.jsx)(n.p,{children:"(Remember a prefab is a type, a template, and a prefab instance is the realization of the prefab in the scene)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"In code, a prefab is a user JavaScript class. A nested prefab is part of a prefab. It is an object referenced by a prefab class field."}),"\n",(0,r.jsx)(n.li,{children:"You cannot define user properties for a nested prefab (check the comment below)."}),"\n",(0,r.jsx)(n.li,{children:"You cannot delete a nested prefab instance."}),"\n",(0,r.jsx)(n.li,{children:"You cannot change the type of a nested prefab instance."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["A nested prefab is an object that is part of a prefab. Its type can be a built-in Phaser type or a prefab. You cannot define user properties for the nested prefab if it has a Phaser built-in type. But, if it has a prefab as a type, you can define user properties for that prefab. Saying it in other words. If you need to add custom properties to a nested prefab (",(0,r.jsx)(n.strong,{children:"A"}),"), then you can create a separated prefab scene (",(0,r.jsx)(n.strong,{children:"B"}),") with user properties, and use that prefab ",(0,r.jsx)(n.strong,{children:"B"})," as type creating the nested prefab ",(0,r.jsx)(n.strong,{children:"A"}),"."]})]})}function d(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},28453:function(e,n,s){s.d(n,{R:()=>a,x:()=>c});var t=s(96540);let r={},i=t.createContext(r);function a(e){let n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);